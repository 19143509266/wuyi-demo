"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[508],{11789:function(dt,j,r){r.r(j),r.d(j,{default:function(){return _}});var H=r(15558),J=r.n(H),K=r(48305),k=r.n(K),d=r(75271),L=r(25298),w=r.n(L),N=r(17069),A=r.n(N),O=r(82092),s=r.n(O),Q=function(){function u(e,n,t,h){w()(this,u),s()(this,"color",void 0),s()(this,"startX",void 0),s()(this,"startY",void 0),s()(this,"endX",void 0),s()(this,"endY",void 0),s()(this,"text",void 0),s()(this,"ctx",void 0),this.ctx=e,this.color=n,this.startX=t,this.startY=h,this.endX=t,this.endY=h,this.text=""}return A()(u,[{key:"MinX",get:function(){return Math.min(this.startX,this.endX)}},{key:"MaxX",get:function(){return Math.max(this.startX,this.endX)}},{key:"MinY",get:function(){return Math.min(this.startY,this.endY)}},{key:"MaxY",get:function(){return Math.max(this.startY,this.endY)}},{key:"draw",value:function(n){var t=this.ctx;t.beginPath(),t.moveTo(this.MinX*n,this.MinY*n),t.lineTo(this.MaxX*n,this.MinY*n),t.lineTo(this.MaxX*n,this.MaxY*n),t.lineTo(this.MinX*n,this.MaxY*n),t.lineTo(this.MinX*n,this.MinY*n),t.fillStyle=this.color,t.fill(),t.lineCap="square",t.strokeStyle="#fff",t.lineWidth=3,t.stroke(),this.text&&(t.font="16px Arial",t.fillStyle="black",t.textAlign="center",t.textBaseline="middle",t.fillText(this.text,(this.MinX+this.MaxX)/2*n,(this.MinY+this.MaxY)/2*n))}},{key:"isInside",value:function(n,t){return n>=this.MinX&&n<=this.MaxX&&t>=this.MinY&&t<=this.MaxY}}]),u}(),U=function(){function u(e,n,t,h){w()(this,u),s()(this,"color",void 0),s()(this,"startX",void 0),s()(this,"startY",void 0),s()(this,"endX",void 0),s()(this,"endY",void 0),s()(this,"text",void 0),s()(this,"ctx",void 0),this.ctx=e,this.color=n,this.startX=t,this.startY=h,this.endX=t,this.endY=h,this.text=""}return A()(u,[{key:"MinX",get:function(){return Math.min(this.startX,this.endX)}},{key:"MaxX",get:function(){return Math.max(this.startX,this.endX)}},{key:"MinY",get:function(){return Math.min(this.startY,this.endY)}},{key:"MaxY",get:function(){return Math.max(this.startY,this.endY)}},{key:"centerX",get:function(){return(this.startX+this.endX)/2}},{key:"centerY",get:function(){return(this.startY+this.endY)/2}},{key:"radius",get:function(){var n=this.endX-this.startX,t=this.endY-this.startY;return Math.sqrt(n*n+t*t)/2}},{key:"draw",value:function(n){var t=this.ctx;t.beginPath(),t.arc(this.centerX*n,this.centerY*n,this.radius*n,0,Math.PI*2),t.fillStyle=this.color,t.fill(),t.lineCap="square",t.strokeStyle="#fff",t.lineWidth=3,t.stroke(),this.text&&(t.font="16px Arial",t.fillStyle="black",t.textAlign="center",t.textBaseline="middle",t.fillText(this.text,this.centerX*n,this.centerY*n))}},{key:"isInside",value:function(n,t){var h=n-this.centerX,o=t-this.centerY;return Math.sqrt(h*h+o*o)<=this.radius}}]),u}(),b=function(){function u(e,n,t,h){w()(this,u),s()(this,"color",void 0),s()(this,"startX",void 0),s()(this,"startY",void 0),s()(this,"endX",void 0),s()(this,"endY",void 0),s()(this,"text",void 0),s()(this,"ctx",void 0),this.ctx=e,this.color=n,this.startX=t,this.startY=h,this.endX=t,this.endY=h,this.text=""}return A()(u,[{key:"MinX",get:function(){return Math.min(this.startX,this.endX)}},{key:"MaxX",get:function(){return Math.max(this.startX,this.endX)}},{key:"MinY",get:function(){return Math.min(this.startY,this.endY)}},{key:"MaxY",get:function(){return Math.max(this.startY,this.endY)}},{key:"centerX",get:function(){return(this.startX+this.endX)/2}},{key:"centerY",get:function(){return(this.startY+this.endY)/2}},{key:"radiusX",get:function(){return Math.abs(this.endX-this.startX)/2}},{key:"radiusY",get:function(){return Math.abs(this.endY-this.startY)/2}},{key:"draw",value:function(n){var t=this.ctx;t.beginPath(),t.ellipse(this.centerX*n,this.centerY*n,this.radiusX*n,this.radiusY*n,0,0,Math.PI*2),t.fillStyle=this.color,t.fill(),t.lineCap="square",t.strokeStyle="#fff",t.lineWidth=3,t.stroke(),this.text&&(t.font="16px Arial",t.fillStyle="black",t.textAlign="center",t.textBaseline="middle",t.fillText(this.text,this.centerX*n,this.centerY*n))}},{key:"isInside",value:function(n,t){var h=(n-this.centerX)/this.radiusX,o=(t-this.centerY)/this.radiusY;return h*h+o*o<=1}}]),u}(),P=r(27606),$=r(74026),C=r(5623),R=r(47528),c=r(52676),q=function(){var e=(0,d.useRef)(null),n=(0,d.useRef)(null),t=(0,d.useState)("rect"),h=k()(t,2),o=h[0],tt=h[1],nt=(0,d.useState)("#1677ff"),Z=k()(nt,2),S=Z[0],et=Z[1],it=(0,d.useState)([]),E=k()(it,2),m=E[0],st=E[1],rt=(0,d.useState)(null),W=k()(rt,2),D=W[0],F=W[1],at=(0,d.useState)(null),G=k()(at,2),I=G[0],V=G[1],z=function(i,Y){for(var f=0;f<m.length;f++)if(m[f].isInside(i,Y))return m[f];return null};(0,d.useEffect)(function(){var a=e.current;if(a){var i=a.getContext("2d");if(i){var Y=800,f=500;a.width=Y*devicePixelRatio,a.height=f*devicePixelRatio,a.style.width="".concat(Y,"px"),a.style.height="".concat(f,"px"),a.style.backgroundColor="#808080",a.onmousedown=function(g){var v=a.getBoundingClientRect(),x=g.clientX-v.left,y=g.clientY-v.top,l=z(x,y);if(l){var p=l.startX,lt=l.startY,ut=l.endX,ot=l.endY;window.onmouseup=function(){window.onmousemove=null,window.onmouseup=null},window.onmousemove=function(M){var B=M.clientX-v.left-x,T=M.clientY-v.top-y;l.startX=p+B,l.endX=ut+B,l.startY=lt+T,l.endY=ot+T}}else{var X=null;o==="rect"?X=new Q(i,S,x,y):o==="round"?X=new U(i,S,x,y):o==="ellipse"&&(X=new b(i,S,x,y)),X&&st(function(M){return[].concat(J()(M),[X])}),window.onmouseup=function(){window.onmousemove=null,window.onmouseup=null},window.onmousemove=function(M){var B=M.clientX-v.left,T=M.clientY-v.top;X&&(X.endX=B,X.endY=T)}}},a.ondblclick=function(g){var v=a.getBoundingClientRect(),x=g.clientX-v.left,y=g.clientY-v.top,l=z(x,y);l&&(F(l),V({x:g.clientX,y:g.clientY,text:l.text}),setTimeout(function(){var p;(p=n.current)===null||p===void 0||p.focus()},0))}}}},[o,S,m]),(0,d.useEffect)(function(){function a(){var i=e.current;if(i){var Y=i.getContext("2d");!Y||!i||(Y.clearRect(0,0,i.width,i.height),m.forEach(function(f){return f.draw(devicePixelRatio)}),requestAnimationFrame(a))}}a()},[m]);var ht=function(){if(D){var i;D.text=((i=n.current)===null||i===void 0||(i=i.input)===null||i===void 0?void 0:i.value)||"",V(null),F(null)}};return(0,c.jsxs)("div",{style:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"},children:[(0,c.jsxs)(P.Z,{style:{marginBottom:6},children:[(0,c.jsx)($.Z,{value:S,onChange:function(i){et(i.toRgbString())}}),(0,c.jsxs)(C.ZP.Group,{value:o,onChange:function(i){return tt(i.target.value)},children:[(0,c.jsx)(C.ZP,{value:"rect",children:"\u77E9\u5F62"}),(0,c.jsx)(C.ZP,{value:"ellipse",children:"\u692D\u5706"}),(0,c.jsx)(C.ZP,{value:"round",children:"\u5706"})]})]}),(0,c.jsx)("canvas",{ref:e}),I&&(0,c.jsx)(R.Z,{ref:n,style:{position:"fixed",left:I.x,top:I.y,display:"block",width:200},defaultValue:I.text,onBlur:ht})]})},_=q}}]);
