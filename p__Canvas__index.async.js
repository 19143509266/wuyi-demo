(self.webpackChunk=self.webpackChunk||[]).push([[508],{77081:function(v,I,s){"use strict";s.r(I),s.d(I,{default:function(){return tt}});var w=s(15558),j=s.n(w),W=s(48305),o=s.n(W),u=s(75271),Y=s(25298),d=s.n(Y),L=s(17069),D=s.n(L),N=s(82092),r=s.n(N),Q=function(){function c(n,e,t,l){d()(this,c),r()(this,"color",void 0),r()(this,"startX",void 0),r()(this,"startY",void 0),r()(this,"endX",void 0),r()(this,"endY",void 0),r()(this,"text",void 0),r()(this,"ctx",void 0),this.ctx=n,this.color=e,this.startX=t,this.startY=l,this.endX=t,this.endY=l,this.text=""}return D()(c,[{key:"MinX",get:function(){return Math.min(this.startX,this.endX)}},{key:"MaxX",get:function(){return Math.max(this.startX,this.endX)}},{key:"MinY",get:function(){return Math.min(this.startY,this.endY)}},{key:"MaxY",get:function(){return Math.max(this.startY,this.endY)}},{key:"draw",value:function(e){var t=this.ctx;t.beginPath(),t.moveTo(this.MinX*e,this.MinY*e),t.lineTo(this.MaxX*e,this.MinY*e),t.lineTo(this.MaxX*e,this.MaxY*e),t.lineTo(this.MinX*e,this.MaxY*e),t.lineTo(this.MinX*e,this.MinY*e),t.fillStyle=this.color,t.fill(),t.lineCap="square",t.strokeStyle="#fff",t.lineWidth=3,t.stroke(),this.text&&(t.font="16px Arial",t.fillStyle="black",t.textAlign="center",t.textBaseline="middle",t.fillText(this.text,(this.MinX+this.MaxX)/2*e,(this.MinY+this.MaxY)/2*e))}},{key:"isInside",value:function(e,t){return e>=this.MinX&&e<=this.MaxX&&t>=this.MinY&&t<=this.MaxY}}]),c}(),U=function(){function c(n,e,t,l){d()(this,c),r()(this,"color",void 0),r()(this,"startX",void 0),r()(this,"startY",void 0),r()(this,"endX",void 0),r()(this,"endY",void 0),r()(this,"text",void 0),r()(this,"ctx",void 0),this.ctx=n,this.color=e,this.startX=t,this.startY=l,this.endX=t,this.endY=l,this.text=""}return D()(c,[{key:"MinX",get:function(){return Math.min(this.startX,this.endX)}},{key:"MaxX",get:function(){return Math.max(this.startX,this.endX)}},{key:"MinY",get:function(){return Math.min(this.startY,this.endY)}},{key:"MaxY",get:function(){return Math.max(this.startY,this.endY)}},{key:"centerX",get:function(){return(this.startX+this.endX)/2}},{key:"centerY",get:function(){return(this.startY+this.endY)/2}},{key:"radius",get:function(){var e=this.endX-this.startX,t=this.endY-this.startY;return Math.sqrt(e*e+t*t)/2}},{key:"draw",value:function(e){var t=this.ctx;t.beginPath(),t.arc(this.centerX*e,this.centerY*e,this.radius*e,0,Math.PI*2),t.fillStyle=this.color,t.fill(),t.lineCap="square",t.strokeStyle="#fff",t.lineWidth=3,t.stroke(),this.text&&(t.font="16px Arial",t.fillStyle="black",t.textAlign="center",t.textBaseline="middle",t.fillText(this.text,this.centerX*e,this.centerY*e))}},{key:"isInside",value:function(e,t){var l=e-this.centerX,f=t-this.centerY;return Math.sqrt(l*l+f*f)<=this.radius}}]),c}(),P=function(){function c(n,e,t,l){d()(this,c),r()(this,"color",void 0),r()(this,"startX",void 0),r()(this,"startY",void 0),r()(this,"endX",void 0),r()(this,"endY",void 0),r()(this,"text",void 0),r()(this,"ctx",void 0),this.ctx=n,this.color=e,this.startX=t,this.startY=l,this.endX=t,this.endY=l,this.text=""}return D()(c,[{key:"MinX",get:function(){return Math.min(this.startX,this.endX)}},{key:"MaxX",get:function(){return Math.max(this.startX,this.endX)}},{key:"MinY",get:function(){return Math.min(this.startY,this.endY)}},{key:"MaxY",get:function(){return Math.max(this.startY,this.endY)}},{key:"centerX",get:function(){return(this.startX+this.endX)/2}},{key:"centerY",get:function(){return(this.startY+this.endY)/2}},{key:"radiusX",get:function(){return Math.abs(this.endX-this.startX)/2}},{key:"radiusY",get:function(){return Math.abs(this.endY-this.startY)/2}},{key:"draw",value:function(e){var t=this.ctx;t.beginPath(),t.ellipse(this.centerX*e,this.centerY*e,this.radiusX*e,this.radiusY*e,0,0,Math.PI*2),t.fillStyle=this.color,t.fill(),t.lineCap="square",t.strokeStyle="#fff",t.lineWidth=3,t.stroke(),this.text&&(t.font="16px Arial",t.fillStyle="black",t.textAlign="center",t.textBaseline="middle",t.fillText(this.text,this.centerX*e,this.centerY*e))}},{key:"isInside",value:function(e,t){var l=(e-this.centerX)/this.radiusX,f=(t-this.centerY)/this.radiusY;return l*l+f*f<=1}}]),c}(),$=s(20029),R=s(69251),A=s(2309),q=s(58482),x=s(52676),_=function(){var n=(0,u.useRef)(null),e=(0,u.useRef)(null),t=(0,u.useState)("rect"),l=o()(t,2),f=l[0],et=l[1],nt=(0,u.useState)("#1677ff"),F=o()(nt,2),B=F[0],it=F[1],st=(0,u.useState)([]),O=o()(st,2),S=O[0],rt=O[1],at=(0,u.useState)(null),G=o()(at,2),K=G[0],V=G[1],lt=(0,u.useState)(null),z=o()(lt,2),b=z[0],H=z[1],J=function(i,M){for(var g=0;g<S.length;g++)if(S[g].isInside(i,M))return S[g];return null};(0,u.useEffect)(function(){var a=n.current;if(a){var i=a.getContext("2d");if(i){var M=800,g=500;a.width=M*devicePixelRatio,a.height=g*devicePixelRatio,a.style.width="".concat(M,"px"),a.style.height="".concat(g,"px"),a.style.backgroundColor="#808080",a.onmousedown=function(m){var X=a.getBoundingClientRect(),p=m.clientX-X.left,k=m.clientY-X.top,h=J(p,k);if(h){var T=h.startX,ht=h.startY,ot=h.endX,ct=h.endY;window.onmouseup=function(){window.onmousemove=null,window.onmouseup=null},window.onmousemove=function(C){var E=C.clientX-X.left-p,Z=C.clientY-X.top-k;h.startX=T+E,h.endX=ot+E,h.startY=ht+Z,h.endY=ct+Z}}else{var y=null;f==="rect"?y=new Q(i,B,p,k):f==="round"?y=new U(i,B,p,k):f==="ellipse"&&(y=new P(i,B,p,k)),y&&rt(function(C){return[].concat(j()(C),[y])}),window.onmouseup=function(){window.onmousemove=null,window.onmouseup=null},window.onmousemove=function(C){var E=C.clientX-X.left,Z=C.clientY-X.top;y&&(y.endX=E,y.endY=Z)}}},a.ondblclick=function(m){var X=a.getBoundingClientRect(),p=m.clientX-X.left,k=m.clientY-X.top,h=J(p,k);h&&(V(h),H({x:m.clientX,y:m.clientY,text:h.text}),setTimeout(function(){var T;(T=e.current)===null||T===void 0||T.focus()},0))}}}},[f,B,S]),(0,u.useEffect)(function(){function a(){var i=n.current;if(i){var M=i.getContext("2d");!M||!i||(M.clearRect(0,0,i.width,i.height),S.forEach(function(g){return g.draw(devicePixelRatio)}),requestAnimationFrame(a))}}a()},[S]);var ut=function(){if(K){var i;K.text=((i=e.current)===null||i===void 0||(i=i.input)===null||i===void 0?void 0:i.value)||"",H(null),V(null)}};return(0,x.jsxs)("div",{style:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"},children:[(0,x.jsxs)($.Z,{style:{marginBottom:6},children:[(0,x.jsx)(R.Z,{value:B,onChange:function(i){it(i.toRgbString())}}),(0,x.jsxs)(A.ZP.Group,{value:f,onChange:function(i){return et(i.target.value)},children:[(0,x.jsx)(A.ZP,{value:"rect",children:"\u77E9\u5F62"}),(0,x.jsx)(A.ZP,{value:"ellipse",children:"\u692D\u5706"}),(0,x.jsx)(A.ZP,{value:"round",children:"\u5706"})]})]}),(0,x.jsx)("canvas",{ref:n}),b&&(0,x.jsx)(q.Z,{ref:e,style:{position:"fixed",left:b.x,top:b.y,display:"block",width:200},defaultValue:b.text,onBlur:ut})]})},tt=_},25298:function(v){function I(s,w){if(!(s instanceof w))throw new TypeError("Cannot call a class as a function")}v.exports=I,v.exports.__esModule=!0,v.exports.default=v.exports},17069:function(v,I,s){var w=s(53795);function j(o,u){for(var Y=0;Y<u.length;Y++){var d=u[Y];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(o,w(d.key),d)}}function W(o,u,Y){return u&&j(o.prototype,u),Y&&j(o,Y),Object.defineProperty(o,"prototype",{writable:!1}),o}v.exports=W,v.exports.__esModule=!0,v.exports.default=v.exports}}]);
