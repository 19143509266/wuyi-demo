(self.webpackChunk=self.webpackChunk||[]).push([[508],{77081:function(a,y,i){"use strict";i.r(y),i.d(y,{default:function(){return tt}});var I=i(15558),A=i.n(I),k=i(48305),Y=i.n(k),d=i(75271),T=i(25298),W=i.n(T),N=i(17069),D=i.n(N),O=i(82092),r=i.n(O),Q=function(){function h(n,e,t,u){W()(this,h),r()(this,"color",void 0),r()(this,"startX",void 0),r()(this,"startY",void 0),r()(this,"endX",void 0),r()(this,"endY",void 0),r()(this,"text",void 0),r()(this,"ctx",void 0),this.ctx=n,this.color=e,this.startX=t,this.startY=u,this.endX=t,this.endY=u,this.text=""}return D()(h,[{key:"MinX",get:function(){return Math.min(this.startX,this.endX)}},{key:"MaxX",get:function(){return Math.max(this.startX,this.endX)}},{key:"MinY",get:function(){return Math.min(this.startY,this.endY)}},{key:"MaxY",get:function(){return Math.max(this.startY,this.endY)}},{key:"draw",value:function(e){var t=this.ctx;t.beginPath(),t.moveTo(this.MinX*e,this.MinY*e),t.lineTo(this.MaxX*e,this.MinY*e),t.lineTo(this.MaxX*e,this.MaxY*e),t.lineTo(this.MinX*e,this.MaxY*e),t.lineTo(this.MinX*e,this.MinY*e),t.fillStyle=this.color,t.fill(),t.lineCap="square",t.strokeStyle="#fff",t.lineWidth=3,t.stroke(),this.text&&(t.font="16px Arial",t.fillStyle="black",t.textAlign="center",t.textBaseline="middle",t.fillText(this.text,(this.MinX+this.MaxX)/2*e,(this.MinY+this.MaxY)/2*e))}},{key:"isInside",value:function(e,t){return e>=this.MinX&&e<=this.MaxX&&t>=this.MinY&&t<=this.MaxY}}]),h}(),U=function(){function h(n,e,t,u){W()(this,h),r()(this,"color",void 0),r()(this,"startX",void 0),r()(this,"startY",void 0),r()(this,"endX",void 0),r()(this,"endY",void 0),r()(this,"text",void 0),r()(this,"ctx",void 0),this.ctx=n,this.color=e,this.startX=t,this.startY=u,this.endX=t,this.endY=u,this.text=""}return D()(h,[{key:"MinX",get:function(){return Math.min(this.startX,this.endX)}},{key:"MaxX",get:function(){return Math.max(this.startX,this.endX)}},{key:"MinY",get:function(){return Math.min(this.startY,this.endY)}},{key:"MaxY",get:function(){return Math.max(this.startY,this.endY)}},{key:"centerX",get:function(){return(this.startX+this.endX)/2}},{key:"centerY",get:function(){return(this.startY+this.endY)/2}},{key:"radius",get:function(){var e=this.endX-this.startX,t=this.endY-this.startY;return Math.sqrt(e*e+t*t)/2}},{key:"draw",value:function(e){var t=this.ctx;t.beginPath(),t.arc(this.centerX*e,this.centerY*e,this.radius*e,0,Math.PI*2),t.fillStyle=this.color,t.fill(),t.lineCap="square",t.strokeStyle="#fff",t.lineWidth=3,t.stroke(),this.text&&(t.font="16px Arial",t.fillStyle="black",t.textAlign="center",t.textBaseline="middle",t.fillText(this.text,this.centerX*e,this.centerY*e))}},{key:"isInside",value:function(e,t){var u=e-this.centerX,c=t-this.centerY;return Math.sqrt(u*u+c*c)<=this.radius}}]),h}(),P=function(){function h(n,e,t,u){W()(this,h),r()(this,"color",void 0),r()(this,"startX",void 0),r()(this,"startY",void 0),r()(this,"endX",void 0),r()(this,"endY",void 0),r()(this,"text",void 0),r()(this,"ctx",void 0),this.ctx=n,this.color=e,this.startX=t,this.startY=u,this.endX=t,this.endY=u,this.text=""}return D()(h,[{key:"MinX",get:function(){return Math.min(this.startX,this.endX)}},{key:"MaxX",get:function(){return Math.max(this.startX,this.endX)}},{key:"MinY",get:function(){return Math.min(this.startY,this.endY)}},{key:"MaxY",get:function(){return Math.max(this.startY,this.endY)}},{key:"centerX",get:function(){return(this.startX+this.endX)/2}},{key:"centerY",get:function(){return(this.startY+this.endY)/2}},{key:"radiusX",get:function(){return Math.abs(this.endX-this.startX)/2}},{key:"radiusY",get:function(){return Math.abs(this.endY-this.startY)/2}},{key:"draw",value:function(e){var t=this.ctx;t.beginPath(),t.ellipse(this.centerX*e,this.centerY*e,this.radiusX*e,this.radiusY*e,0,0,Math.PI*2),t.fillStyle=this.color,t.fill(),t.lineCap="square",t.strokeStyle="#fff",t.lineWidth=3,t.stroke(),this.text&&(t.font="16px Arial",t.fillStyle="black",t.textAlign="center",t.textBaseline="middle",t.fillText(this.text,this.centerX*e,this.centerY*e))}},{key:"isInside",value:function(e,t){var u=(e-this.centerX)/this.radiusX,c=(t-this.centerY)/this.radiusY;return u*u+c*c<=1}}]),h}(),$=i(20029),R=i(69251),j=i(2309),q=i(61138),f=i(52676),_=function(){var n=(0,d.useRef)(null),e=(0,d.useRef)(null),t=(0,d.useState)("rect"),u=Y()(t,2),c=u[0],et=u[1],nt=(0,d.useState)("#1677ff"),F=Y()(nt,2),B=F[0],it=F[1],st=(0,d.useState)([]),H=Y()(st,2),C=H[0],rt=H[1],at=(0,d.useState)(null),G=Y()(at,2),L=G[0],V=G[1],ot=(0,d.useState)(null),z=Y()(ot,2),b=z[0],J=z[1],K=function(s,g){for(var v=0;v<C.length;v++)if(C[v].isInside(s,g))return C[v];return null};(0,d.useEffect)(function(){var o=n.current;if(o){var s=o.getContext("2d");if(s){var g=800,v=500;o.width=g*devicePixelRatio,o.height=v*devicePixelRatio,o.style.width="".concat(g,"px"),o.style.height="".concat(v,"px"),o.style.backgroundColor="#808080",o.onmousedown=function(p){var x=o.getBoundingClientRect(),M=p.clientX-x.left,m=p.clientY-x.top,l=K(M,m);if(l){var w=l.startX,lt=l.startY,ht=l.endX,dt=l.endY;window.onmouseup=function(){window.onmousemove=null,window.onmouseup=null},window.onmousemove=function(S){var E=S.clientX-x.left-M,Z=S.clientY-x.top-m;l.startX=w+E,l.endX=ht+E,l.startY=lt+Z,l.endY=dt+Z}}else{var X=null;c==="rect"?X=new Q(s,B,M,m):c==="round"?X=new U(s,B,M,m):c==="ellipse"&&(X=new P(s,B,M,m)),X&&rt(function(S){return[].concat(A()(S),[X])}),window.onmouseup=function(){window.onmousemove=null,window.onmouseup=null},window.onmousemove=function(S){var E=S.clientX-x.left,Z=S.clientY-x.top;X&&(X.endX=E,X.endY=Z)}}},o.ondblclick=function(p){var x=o.getBoundingClientRect(),M=p.clientX-x.left,m=p.clientY-x.top,l=K(M,m);l&&(V(l),J({x:p.clientX,y:p.clientY,text:l.text}),setTimeout(function(){var w;(w=e.current)===null||w===void 0||w.focus()},0))}}}},[c,B,C]),(0,d.useEffect)(function(){function o(){var s=n.current;if(s){var g=s.getContext("2d");!g||!s||(g.clearRect(0,0,s.width,s.height),C.forEach(function(v){return v.draw(devicePixelRatio)}),requestAnimationFrame(o))}}o()},[C]);var ut=function(){if(L){var s;L.text=((s=e.current)===null||s===void 0||(s=s.input)===null||s===void 0?void 0:s.value)||"",J(null),V(null)}};return(0,f.jsxs)("div",{style:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"},children:[(0,f.jsxs)($.Z,{style:{marginBottom:6},children:[(0,f.jsx)(R.Z,{value:B,onChange:function(s){it(s.toRgbString())}}),(0,f.jsxs)(j.ZP.Group,{value:c,onChange:function(s){return et(s.target.value)},children:[(0,f.jsx)(j.ZP,{value:"rect",children:"\u77E9\u5F62"}),(0,f.jsx)(j.ZP,{value:"ellipse",children:"\u692D\u5706"}),(0,f.jsx)(j.ZP,{value:"round",children:"\u5706"})]})]}),(0,f.jsx)("canvas",{ref:n}),b&&(0,f.jsx)(q.Z,{ref:e,style:{position:"fixed",left:b.x,top:b.y,display:"block",width:200},defaultValue:b.text,onBlur:ut})]})},tt=_},38498:function(a,y,i){var I=i(78770);function A(k){if(Array.isArray(k))return I(k)}a.exports=A,a.exports.__esModule=!0,a.exports.default=a.exports},20698:function(a){function y(i){if(typeof Symbol!="undefined"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}a.exports=y,a.exports.__esModule=!0,a.exports.default=a.exports},91162:function(a){function y(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}a.exports=y,a.exports.__esModule=!0,a.exports.default=a.exports},15558:function(a,y,i){var I=i(38498),A=i(20698),k=i(31479),Y=i(91162);function d(T){return I(T)||A(T)||k(T)||Y()}a.exports=d,a.exports.__esModule=!0,a.exports.default=a.exports}}]);
