(("undefined"!=typeof globalThis?globalThis:self).makoChunk_global=("undefined"!=typeof globalThis?globalThis:self).makoChunk_global||[]).push([["src/pages/ConditionRelation/index.tsx"],{"src/pages/ConditionRelation/index.tsx":function(e,l,i){i.d(l,"__esModule",{value:!0}),i.e(l,{default:function(){return $;}});var d=i("@swc/helpers/_/_interop_require_default"),t=i("@swc/helpers/_/_interop_require_wildcard"),n=i("node_modules/.pnpm/react@18.3.1/node_modules/react/jsx-runtime.js"),o=i("node_modules/.pnpm/react@18.3.1/node_modules/react/index.js"),s=t._(o);let r=(e,l)=>(e.forEach(e=>{var i;(null===(i=e.child)||void 0===i?void 0:i.length)?l=r(e.child,l):l+=1;}),l+=1),a=(e,l)=>(e.child.forEach(i=>{var d;if(i.x=e.x+1,null===(d=i.child)||void 0===d?void 0:d.length){let e=r(i.child,0);i.y=Math.floor(e/2)+l,l=a(i,l);}else l+=1,i.y=l-1;}),l+=1),c=e=>{var l;let[i]=e;return(null===(l=i.child)||void 0===l?void 0:l.length)?c(i.child):i.y;},h=e=>{let l=e.child.length;if(!l)return"";let i="",{x:d,y:t}=e;return e.child.forEach((n,o)=>{var s,a,u,m;let{y:g,z:f}=n;if(null===(s=n.child)||void 0===s?void 0:s.length){let l=41.4*r(e.child,0)/2+41.4*(c(e.child)||0),o=41.4*r(n.child,0)/2+41.4*c(n.child),s=0,a=0;l<o?(s=l,a=o):[s,a]=[o,l],t>=g&&(s=l,a=o),i+=`M${24+68*d} ${s} L${24+68*d} ${a} L${68+68*d} ${a}`+h(n);}(null===(a=n.child)||void 0===a?void 0:a.length)||(g>=t?i+=`M${24+68*d} ${40*t} L${24+68*d} ${(g+1)*41.4-20.69921875} L${68+68*d} ${(g+1)*41.4-20.69921875}`:i+=`M${24+68*d} ${(g+(1===l&&0===o?0:1)+((null===(m=e.child[o+1])||void 0===m?void 0:null===(u=m.child)||void 0===u?void 0:u.length)?t-g-1:0))*41.4+20+(1===l&&0===o?26:0)} L${24+68*d} ${(g+1)*41.4-20.69921875-(1===l&&0===o?1.4*(f||0):0)} L${68+68*d} ${(g+1)*41.4-20.69921875-(1===l&&0===o?1.4*(f||0):0)}`);}),i;},u=(e,l)=>(e.child.forEach(i=>{var d;l=(null===(d=i.child)||void 0===d?void 0:d.length)?u(i,l):Math.max(l,i.y,e.y);}),l),m=e=>{var l,i;let d=null===(l=e.child)||void 0===l?void 0:l.length,t="";if(!d&&Array.isArray(e.child)){let{x:l,y:i}=e;t+=`M${48+68*l} ${41.4*i+20} L${88+68*l} ${41.4*i+20}`;}else if(null===(i=e.child)||void 0===i?void 0:i.length){let l=Math.max(u(e,0),r(e.child,0)+c(e.child)-1),i=41.4*r(e.child,0)/2+41.4*(c(e.child)||0),{x:d}=e;t+=`M${24+68*d} ${i} L${24+68*d} ${41.4*l+20} L${64+68*d} ${41.4*l+20}`,e.child.forEach(e=>{t+=m(e);});}return t;};var g=i("node_modules/.pnpm/@ant-design+icons@5.5.1_react-dom@18.3.1_react@18.3.1/node_modules/@ant-design/icons/es/icons/DeleteOutlined.js"),f=d._(g),y=i("node_modules/.pnpm/antd@5.21.5_react-dom@18.3.1_react@18.3.1/node_modules/antd/es/dropdown/index.js"),p=d._(y),v=i("node_modules/.pnpm/uuid@10.0.0/node_modules/uuid/dist/esm-browser/v4.js"),x=d._(v);let k=()=>(0,n.jsx)("div",{className:"filed",style:{width:750},children:"\u5B57\u6BB5"}),j=[{key:"and",label:"and"},{key:"or",label:"or"}],_=e=>{let{x:l,relationList:i,logic:d,addCondReal:t,setRelationList:o,removeRelationList:r,setLogic:a}=e,c=(e,l)=>e.map(e=>{let i="and"===l?"or":"and";return e.child?{...e,logic:i,child:c(e.child,i)}:{...e,logic:i};}),h=(0,s.useMemo)(()=>({marginLeft:l?"20px":0}),[]),u=(e,l,i)=>{let d="condition"===e?{fieldId:"",value:"",enumValue:"",term:"",filterType:"logic",name:"",deType:"",key:(0,x.default)()}:{child:[],logic:i,key:(0,x.default)()};o(e=>e.map(e=>e.key===l?{...e,child:[...e.child,d]}:e.child&&e.child.length>0?{...e,child:e.child.map(e=>e.key===l?{...e,child:[...e.child,d]}:e)}:e));},m=e=>{o(l=>l.find(l=>l.key===e.key)?l.filter(l=>l.key!==e.key):l.map(l=>{if(l.child){let i=l.child.filter(l=>l.key!==e.key);return{...l,child:i};}return l;}));};return(0,n.jsxs)("div",{className:"logic",style:h,children:[(0,n.jsx)("div",{className:"logic-left",children:(0,n.jsx)("div",{className:"operate-title",children:l?(0,n.jsxs)("div",{style:{display:"flex"},children:[(0,n.jsx)("span",{style:{color:"#bfbfbf"},className:"mrg-title",children:"or"===d?"OR":"AND"}),(0,n.jsx)("span",{className:"operate-icon",children:(0,n.jsx)(f.default,{onClick:e=>r(e)})})]}):(0,n.jsx)(p.default,{menu:{items:j,onClick:e=>{a(e.key),o(l=>c(l,e.key));}},placement:"bottom",trigger:["click"],children:(0,n.jsx)("span",{style:{color:"rgba(0 0 0 / 65%)"},className:"mrg-title fir",children:"or"===d?"OR":"AND"})})})}),(0,n.jsxs)("div",{className:"logic-right",children:[i.map((e,l)=>e.child?(0,n.jsx)(_,{x:e.x,logic:e.logic,relationList:e.child,addCondReal:(l,i)=>u(l,e.key,i),setRelationList:o,removeRelationList:()=>m(e),setLogic:a},e.key):(0,n.jsx)(k,{},e.key)),(0,n.jsxs)("div",{className:"logic-right-add",children:[(0,n.jsx)("button",{onClick:()=>t("condition","or"===d?"and":"or"),className:"operand-btn",children:"+\u6DFB\u52A0\u6761\u4EF6"}),l<2&&(0,n.jsx)("button",{onClick:()=>t("relation","or"===d?"and":"or"),className:"operand-btn",children:"+\u6DFB\u52A0\u5173\u7CFB"})]})]})]});},$=()=>{let[e,l]=(0,s.useState)([]),[i,d]=(0,s.useState)("or"),t=(0,s.useMemo)(()=>{let l=e.length,i={x:0,y:0,child:e};return(i.y=Math.floor(a(i,0)/2),l)?h(i):"";},[e]),o=(0,s.useMemo)(()=>{let l=e.length,i={x:0,y:0,child:e};return(i.y=Math.floor(a(i,0)/2),l)?m(i):"M48 20 L68 20";},[e]);return(0,n.jsx)("div",{style:{height:"100%",width:"100%",justifyContent:"center",alignItems:"center",display:"flex",background:"#d3d3d3",padding:12,boxSizing:"border-box"},children:(0,n.jsxs)("div",{style:{width:850,background:"#fff",display:"flex",alignItems:"center",position:"relative"},children:[(0,n.jsx)(_,{x:0,relationList:e,logic:i,addCondReal:(e,i)=>{let d="condition"===e?{fieldId:"",value:"",enumValue:"",term:"",filterType:"logic",name:"",deType:"",key:(0,x.default)()}:{child:[],logic:i,key:(0,x.default)()};l(e=>[...e,d]);},setRelationList:l,removeRelationList:e=>{l([]);},setLogic:d}),(0,n.jsx)("svg",{width:"388",height:"100%",className:"real-line",children:(0,n.jsx)("path",{strokeLinejoin:"round",strokeLinecap:"round",d:t,fill:"none",stroke:"#CCCCCC",strokeWidth:"0.5"})}),(0,n.jsx)("svg",{width:"388",height:"100%",className:"dash-line",children:(0,n.jsx)("path",{strokeLinejoin:"round",strokeLinecap:"round",d:o,fill:"none",stroke:"#CCCCCC",strokeWidth:"0.5",strokeDasharray:"4,4"})})]})});};}}]);
//# sourceMappingURL=src_pages_ConditionRelation_index_tsx-async.js.map